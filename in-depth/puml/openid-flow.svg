<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="770px" preserveAspectRatio="none" style="width:997px;height:770px;background:#FFFFFF;" version="1.1" viewBox="0 0 997 770" width="997px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="451.25" y="27.9951">Openid Flow</text><rect fill="none" height="249.0625" style="stroke:#000000;stroke-width:1.5;" width="430" x="561.5" y="235.9922"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="410" x="571.5" y="360.5234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="28" x2="28" y1="118.5938" y2="689.8516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="186.5" x2="186.5" y1="118.5938" y2="689.8516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="637.5" x2="637.5" y1="118.5938" y2="689.8516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="910.5" x2="910.5" y1="118.5938" y2="689.8516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="115.292">Actor</text><ellipse cx="28" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28,58.7969 L28,85.7969 M15,66.7969 L41,66.7969 M28,85.7969 L15,100.7969 M28,85.7969 L41,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="701.8467">Actor</text><ellipse cx="28" cy="713.6484" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28,721.6484 L28,748.6484 M15,729.6484 L41,729.6484 M28,748.6484 L15,763.6484 M28,748.6484 L41,763.6484 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="158.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="165.5" y="107.292">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="158.5" y="688.8516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="165.5" y="708.8467">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="581.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="588.5" y="107.292">DG_BACKEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="581.5" y="688.8516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="588.5" y="708.8467">DG_BACKEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="850.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="857.5" y="107.292">DG_FRONTEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="850.5" y="688.8516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="857.5" y="708.8467">DG_FRONTEND</text><polygon fill="#181818" points="175,145.7266,185,149.7266,175,153.7266,179,149.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="28" x2="181" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="35" y="144.6606">Sign in with defguard</text><polygon fill="#181818" points="626,174.8594,636,178.8594,626,182.8594,630,178.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187" x2="632" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="194" y="173.7935">Redirect on /authorize url with client parameters</text><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="680" y1="207.9922" y2="207.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="680" x2="680" y1="207.9922" y2="220.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="639" x2="680" y1="220.9922" y2="220.9922"/><polygon fill="#181818" points="649,216.9922,639,220.9922,649,224.9922,645,220.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="645" y="202.9263">Check if user is authorized</text><path d="M561.5,235.9922 L627.5,235.9922 L627.5,243.125 L617.5,253.125 L561.5,253.125 L561.5,235.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="249.0625" style="stroke:#000000;stroke-width:1.5;" width="430" x="561.5" y="235.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="576.5" y="249.0591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132" x="642.5" y="248.2026">[user unauthorized]</text><polygon fill="#181818" points="899,270.2578,909,274.2578,899,278.2578,903,274.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="905" y1="274.2578" y2="274.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="645" y="269.1919">Redirect to login page</text><polygon fill="#181818" points="649,299.3906,639,303.3906,649,307.3906,645,303.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="643" x2="910" y1="303.3906" y2="303.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="655" y="298.3247">Authorize user /login</text><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="680" y1="332.5234" y2="332.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="680" x2="680" y1="332.5234" y2="345.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="639" x2="680" y1="345.5234" y2="345.5234"/><polygon fill="#181818" points="649,341.5234,639,345.5234,649,349.5234,645,345.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="645" y="327.4575">Check if MFA enabled for user</text><path d="M571.5,360.5234 L637.5,360.5234 L637.5,367.6563 L627.5,377.6563 L571.5,377.6563 L571.5,360.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="410" x="571.5" y="360.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="586.5" y="373.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="652.5" y="372.7339">[user mfa enabled]</text><polygon fill="#181818" points="899,394.7891,909,398.7891,899,402.7891,903,398.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="905" y1="398.7891" y2="398.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="645" y="393.7231">MFA with 201 status code</text><polygon fill="#181818" points="649,423.9219,639,427.9219,649,431.9219,645,427.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="643" x2="910" y1="427.9219" y2="427.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="655" y="422.856">MFA request</text><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="680" y1="457.0547" y2="457.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="680" x2="680" y1="457.0547" y2="470.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="639" x2="680" y1="470.0547" y2="470.0547"/><polygon fill="#181818" points="649,466.0547,639,470.0547,649,474.0547,645,470.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="645" y="451.9888">Validate MFA</text><polygon fill="#181818" points="39,509.1875,29,513.1875,39,517.1875,35,513.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="33" x2="637" y1="513.1875" y2="513.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="45" y="508.1216">302 Redirect to consent</text><polygon fill="#181818" points="626,538.3203,636,542.3203,626,546.3203,630,542.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="28" x2="632" y1="542.3203" y2="542.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="35" y="537.2544">Authorization and consent /authorize</text><line style="stroke:#181818;stroke-width:1.0;" x1="638" x2="680" y1="571.4531" y2="571.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="680" x2="680" y1="571.4531" y2="584.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="639" x2="680" y1="584.4531" y2="584.4531"/><polygon fill="#181818" points="649,580.4531,639,584.4531,649,588.4531,645,584.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="645" y="566.3872">Validate client id, scopes and redirect url</text><polygon fill="#181818" points="198,609.5859,188,613.5859,198,617.5859,194,613.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="192" x2="637" y1="613.5859" y2="613.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="204" y="608.52">302 Redirect with authorization code on client specified redirect url</text><polygon fill="#181818" points="626,638.7188,636,642.7188,626,646.7188,630,642.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187" x2="632" y1="642.7188" y2="642.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411" x="194" y="637.6528">Send authorization code and state using POST method to /token</text><polygon fill="#181818" points="198,667.8516,188,671.8516,198,675.8516,194,671.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="192" x2="637" y1="671.8516" y2="671.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="204" y="666.7856">ID Token, Access token and refresh token</text><!--SRC=[ZPD1JiCm44NtESKS0DHITbqWXPOYX6XHMx55nfuaexfsi1rLulJOJaAQK28MYPJnpFVpzuyZ9n4s9IeIi9Bwb33kj84qlfc5-DaKh-zW8GcLcyEESWMau4Ik085PNZ4Zaderz2qVt-_JnVF3UZc7BGeoo1re1HDMkK8R-aAeZAp7UJrLCiEEwD3Of9iUQi6YG7u0og2oQ80yO2ie4YPTNQxKMVMNs6gxMU_xP4w3rBa_JyboJCvwXlkd7NxOQ1AdHdX_S5zMAQ1Y7n85PDxBCDu17pFMhexn1f5esMnw0zOnLrdWMemIXnc3dnLQDyBvnYG9vZ2q9wX4VFhjCGDpk9tEUhvnhQo_lYuY_Vjg3MEE_FKp9Tg1yoZy1wn92Oahi5oNQAEOQKbycWOgRLHxmD4zrcCA1ePeDXlO4ZbbX0Fjoz7UUPikoGMqS3yX9gHoUDtizk33NMWHF9iuVK3r1-_J4lPX-Sh_X1ojXTZSd3OpQ8kwyWq0]--></g></svg>