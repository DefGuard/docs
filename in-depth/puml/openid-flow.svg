<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="843px" preserveAspectRatio="none" style="width:1128px;height:843px;background:#FFFFFF;" version="1.1" viewBox="0 0 1128 843" width="1128px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98" x="516.75" y="27.9951">Openid Flow</text><rect fill="none" height="249.0625" style="stroke:#000000;stroke-width:1.5;" width="497" x="625.5" y="235.9922"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="477" x="635.5" y="360.5234"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="477" x="635.5" y="541.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="28" x2="28" y1="118.5938" y2="763.1172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="186.5" x2="186.5" y1="118.5938" y2="763.1172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="701.5" x2="701.5" y1="118.5938" y2="763.1172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1041.5" x2="1041.5" y1="118.5938" y2="763.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="115.292">Actor</text><ellipse cx="28" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28,58.7969 L28,85.7969 M15,66.7969 L41,66.7969 M28,85.7969 L15,100.7969 M28,85.7969 L41,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="775.1123">Actor</text><ellipse cx="28" cy="786.9141" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28,794.9141 L28,821.9141 M15,802.9141 L41,802.9141 M28,821.9141 L15,836.9141 M28,821.9141 L41,836.9141 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="158.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="165.5" y="107.292">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="158.5" y="762.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="165.5" y="782.1123">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="645.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="652.5" y="107.292">DG_BACKEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="645.5" y="762.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="652.5" y="782.1123">DG_BACKEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="981.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="988.5" y="107.292">DG_FRONTEND</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="981.5" y="762.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="988.5" y="782.1123">DG_FRONTEND</text><polygon fill="#181818" points="175,145.7266,185,149.7266,175,153.7266,179,149.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="28" x2="181" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="35" y="144.6606">Sign in with defguard</text><polygon fill="#181818" points="690,174.8594,700,178.8594,690,182.8594,694,178.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187" x2="696" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389" x="194" y="173.7935">Redirect on api/v1/oauth/authorize url with client parameters</text><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="744" y1="207.9922" y2="207.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="744" x2="744" y1="207.9922" y2="220.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="703" x2="744" y1="220.9922" y2="220.9922"/><polygon fill="#181818" points="713,216.9922,703,220.9922,713,224.9922,709,220.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="709" y="202.9263">Check if user is authorized</text><path d="M625.5,235.9922 L691.5,235.9922 L691.5,243.125 L681.5,253.125 L625.5,253.125 L625.5,235.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="249.0625" style="stroke:#000000;stroke-width:1.5;" width="497" x="625.5" y="235.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="640.5" y="249.0591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132" x="706.5" y="248.2026">[user unauthorized]</text><polygon fill="#181818" points="1030,270.2578,1040,274.2578,1030,278.2578,1034,274.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="1036" y1="274.2578" y2="274.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="709" y="269.1919">Redirect to login page</text><polygon fill="#181818" points="713,299.3906,703,303.3906,713,307.3906,709,303.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="707" x2="1041" y1="303.3906" y2="303.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="719" y="298.3247">Authorize user api/v1/auth/login</text><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="744" y1="332.5234" y2="332.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="744" x2="744" y1="332.5234" y2="345.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="703" x2="744" y1="345.5234" y2="345.5234"/><polygon fill="#181818" points="713,341.5234,703,345.5234,713,349.5234,709,345.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="709" y="327.4575">Check if MFA enabled for user</text><path d="M635.5,360.5234 L701.5,360.5234 L701.5,367.6563 L691.5,377.6563 L635.5,377.6563 L635.5,360.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:1.5;" width="477" x="635.5" y="360.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="650.5" y="373.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="716.5" y="372.7339">[user mfa enabled]</text><polygon fill="#181818" points="1030,394.7891,1040,398.7891,1030,402.7891,1034,398.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="1036" y1="398.7891" y2="398.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="709" y="393.7231">return MFA info with 201 status code</text><polygon fill="#181818" points="713,423.9219,703,427.9219,713,431.9219,709,427.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="707" x2="1041" y1="427.9219" y2="427.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="719" y="422.856">MFA request</text><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="744" y1="457.0547" y2="457.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="744" x2="744" y1="457.0547" y2="470.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="703" x2="744" y1="470.0547" y2="470.0547"/><polygon fill="#181818" points="713,466.0547,703,470.0547,713,474.0547,709,470.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="709" y="451.9888">Validate MFA</text><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="744" y1="513.1875" y2="513.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="744" x2="744" y1="513.1875" y2="526.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="703" x2="744" y1="526.1875" y2="526.1875"/><polygon fill="#181818" points="713,522.1875,703,526.1875,713,530.1875,709,526.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="709" y="508.1216">Check if user authorized client before</text><path d="M635.5,541.1875 L701.5,541.1875 L701.5,548.3203 L691.5,558.3203 L635.5,558.3203 L635.5,541.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="477" x="635.5" y="541.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="650.5" y="554.2544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="195" x="716.5" y="553.3979">[Client unauthorized by user]</text><polygon fill="#181818" points="1030,575.4531,1040,579.4531,1030,583.4531,1034,579.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="1036" y1="579.4531" y2="579.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="709" y="574.3872">302 Redirect to consent</text><polygon fill="#181818" points="713,604.5859,703,608.5859,713,612.5859,709,608.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="707" x2="1041" y1="608.5859" y2="608.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="719" y="603.52">Authorization and consent api/v1/oauth/authorize</text><line style="stroke:#181818;stroke-width:1.0;" x1="702" x2="744" y1="644.7188" y2="644.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="744" x2="744" y1="644.7188" y2="657.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="703" x2="744" y1="657.7188" y2="657.7188"/><polygon fill="#181818" points="713,653.7188,703,657.7188,713,661.7188,709,657.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="709" y="639.6528">Validate client id, scopes and redirect url</text><polygon fill="#181818" points="198,682.8516,188,686.8516,198,690.8516,194,686.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="192" x2="701" y1="686.8516" y2="686.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="204" y="681.7856">302 Redirect with authorization code on client specified redirect url</text><polygon fill="#181818" points="690,711.9844,700,715.9844,690,719.9844,694,715.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187" x2="696" y1="715.9844" y2="715.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491" x="194" y="710.9185">Send authorization code and state using POST method to api/v1/oauth/token</text><polygon fill="#181818" points="198,741.1172,188,745.1172,198,749.1172,194,745.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="192" x2="701" y1="745.1172" y2="745.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="204" y="740.0513">ID Token, Access token, Refresh token</text><!--SRC=[ZLJBJkim4DtdA-O3GEMnOu5Ksbk441Ir5LlasfDaHB23FG71r-D7qZQv45Z4ab_7vp4J9guGbZLgKh2ep7ic91iBqpWA1t7QBXvVmgmYr7m1Qoeqa8PtuX8KvaKZhChIRZWtltwwcivk_ztFBs25YYnA1gD1r3HvEvqOqN0v2OEnz8dGs2f1oOHG2ojUaD6wR8yqn8LPYV8PA8V6eGNoP3j0bOcAqtAZ3rR_0rkiblURFaisK9d2Qwj5WTd1cU7xqptzy50hBIgB02FKTypl5bD0BROLAiYznG5fp_qb5ztk67MBt5WTiKZd9ZbvTd8AZWKt3gHHeqB2HOkl3JeUuVmeAbA2CHpFKAlu_K5YCcUNGHVn5hrUZ5hRiZbC2hOVoOiHsUSdPxtKfD7EumoLzckc2qqmXNBKghlsKsd-8dFdIYkBr14uQMfq4Tns_7o53r2wLkh9YD697iUGNcYTzW5NewISS83zVUkjFVdlu0ArK1oXT4aNyB1SRy0tN6bKSB9d1Pjdr3zmlvd39cmV-H-6HEU0qso5kKLNfkaN]--></g></svg>